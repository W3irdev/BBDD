/*1*/

SELECT AVG(DTO) 
FROM FACTURAS f ;

/*2*/

SELECT AVG(DTO)
FROM FACTURAS f;

/*3*/

SELECT NVL(AVG(DTO),0)
FROM FACTURAS f;

/*4*/

SELECT COUNT(f.CODFAC) 
FROM FACTURAS f ;

/*5*/

SELECT count(p.CODPUE)
FROM PUEBLOS p , PROVINCIAS p2 
WHERE p.CODPRO =p2.CODPRO 
AND p2.NOMBRE  IN ('VALENCIA','ALICANTE','CASTELLON');

/*6*/

SELECT sum(precio*STOCK)
FROM ARTICULOS a;

/*7*/

SELECT count(p.CODPUE)
FROM PUEBLOS p , CLIENTES c 
WHERE p.CODPUE = c.CODPUE 
AND c.CODPOSTAL LIKE '12%';

/*8*/

SELECT MAX(a.STOCK) , MIN(a.STOCK) , MAX(a.STOCK)-MIN(a.STOCK) 
FROM ARTICULOS a 
WHERE a.PRECIO BETWEEN 9 AND 12;

/*9*/

SELECT AVG(a.PRECIO) 
FROM ARTICULOS a 
WHERE a.STOCK > 10;

/*10*/

SELECT MIN(f.FECHA) , MAX(f.FECHA)  
FROM FACTURAS f
WHERE f.CODCLI = 210;

/*11*/

SELECT COUNT(a.CODART) 
FROM ARTICULOS a 
WHERE a.STOCK IS null;

/*12*/

SELECT COUNT(lf.CODFAC) 
FROM LINEAS_FAC lf 
WHERE lf.DTO IS NULL;

/*13*/

SELECT count(f.CODFAC)  
FROM FACTURAS f
GROUP BY f.CODCLI ;

/*14*/

SELECT CODCLI , count(CODFAC)  
FROM FACTURAS
GROUP BY CODCLI 
HAVING count(CODFAC)>=2;

/*15*/

SELECT SUM(lf.PRECIO * lf.CANT) 
FROM LINEAS_FAC lf;

/*16*/

SELECT SUM(lf.PRECIO * a.STOCK) 
FROM ARTICULOS a , LINEAS_FAC lf
where upper(a.CODART) LIKE '%A%';

/*17*/

SELECT count(f.CODFAC), f.FECHA 
FROM FACTURAS f
GROUP BY f.FECHA ;

/*18*/

SELECT count(c.CODCLI) , p.NOMBRE 
FROM PUEBLOS p , CLIENTES c 
WHERE p.CODPUE  = c.CODPUE
GROUP BY p.NOMBRE
ORDER BY count(c.CODCLI) DESC;

/*19*/

SELECT count(c.CODCLI) , p.NOMBRE 
FROM PUEBLOS p , CLIENTES c 
WHERE p.CODPUE  = c.CODPUE
GROUP BY p.NOMBRE
HAVING count(c.CODCLI)>2
ORDER BY count(c.CODCLI ) DESC;

/*20*/

SELECT count(a.CODART)*lf.CANT AS Total_vendido, a.DESCRIP 
FROM ARTICULOS a , LINEAS_FAC lf 
WHERE a.CODART = lf.CODART 
AND a.CODART  LIKE 'P%'
GROUP BY lf.CANT, a.DESCRIP  ;

/*Uno perdio por ahi*/

SELECT min(lf.PRECIO) AS Precio_Minimo, max(lf.PRECIO) AS Precio_maximo
FROM LINEAS_FAC lf , ARTICULOS a 
WHERE  a.CODART LIKE 'C%'
GROUP BY lf.CODFAC  ;

/*21*/

SELECT min(lf.PRECIO) AS Precio_Minimo, max(lf.PRECIO) AS Precio_maximo, max(lf.PRECIO)-min(lf.PRECIO) AS Diferencia 
FROM LINEAS_FAC lf , ARTICULOS a 
WHERE  a.CODART LIKE 'C%'
GROUP BY lf.CODFAC  ;


/*22*/

SELECT a.DESCRIP 
FROM ARTICULOS a , LINEAS_FAC lf 
WHERE a.CODART = lf.CODART AND lf.PRECIO*lf.CANT>10000;

/*23*/

SELECT count(f.CODFAC), c.CODCLI , f.IVA 
FROM FACTURAS f , CLIENTES c 
WHERE c.CODCLI = f.CODCLI 
AND c.CODCLI BETWEEN 150 AND 300
GROUP BY c.CODCLI, f.IVA  ;

/*24*/

SELECT AVG(lf.CANT*lf.PRECIO) 
FROM LINEAS_FAC lf;































